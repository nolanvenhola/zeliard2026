NAME=x86: aeso on call
FILE=malloc://1024
CMDS=<<EOF
wx 0xfa 0x31 0xc0 0x8e 0xd0 0xf7 0xd0 0x89 0xc4 0xe8 0x01 0x00 0xf4 0xc3
aei
aeim 0xff00 0x100
e asm.arch=x86
e asm.bits=16
e asm.flags.middle=1
6aeso
ar ip
ar ip = 0
7aes
ar ip
EOF
EXPECT=<<EOF
ip = 0x000c
ip = 0x000c
EOF
RUN

NAME=x86-16 dos syscall
FILE==
ARGS=-ax86 -b16 -kdos
CMDS=<<EOF
wa "mov ah,0x30;int 0x21"
aecu 0x4
as
EOF
EXPECT=<<EOF
48 = GetDOSVersion ()
EOF
RUN
