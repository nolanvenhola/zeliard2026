NAME=search count
FILE=bins/elf/analysis/x86-helloworld-gcc
CMDS=<<EOF
ph crc32 @ 0x804830a
/ch crc32 83618b8a
EOF
EXPECT=<<EOF
83618b8a
0x0804830a 256 hit.crc32.0
EOF
RUN

NAME=cmd.hit for /ch
FILE=malloc://1024
CMDS=<<EOF
e search.in=raw
ph md5 @ 0x0
/ch md5 348a9791dc41b89796ec3808b5b5262f
EOF
EXPECT=<<EOF
348a9791dc41b89796ec3808b5b5262f
0x00000000 256 hit.md5.0
0x00000100 256 hit.md5.1
0x00000200 256 hit.md5.2
0x00000300 256 hit.md5.3
EOF
RUN

NAME=cmd.hit for /ch sha256
FILE=bins/firmware/main.bin
CMDS=<<EOF
ph sha256 @! 512 @ 0x64
/ch sha256 83264abaf298b9238ca63cb2fd9ff0f41a7a1520ee2a17c56df459fc806de1d6 512
EOF
EXPECT=<<EOF
83264abaf298b9238ca63cb2fd9ff0f41a7a1520ee2a17c56df459fc806de1d6
0x00000064 512 hit.sha256.0
EOF
RUN
