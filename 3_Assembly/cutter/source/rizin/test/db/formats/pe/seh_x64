NAME=PE: seh_x64.exe - open
FILE=bins/pe/seh_x64.exe
CMDS=q!
EXPECT=
RUN

NAME=PE: seh_x64.exe - Get trycatchs
FILE=bins/pe/seh_x64.exe
CMDS=iw;iwj
EXPECT=<<EOF
     source        from          to     handler      filter 
------------------------------------------------------------
0x140001010 0x14000104c 0x140001066 0x140001066  0x00000000
0x140001010 0x140001022 0x140001076 0x140001076  0x00000000
0x140001010 0x140001084 0x140001094 0x140001094 0x140001d30
0x140001170 0x140001192 0x1400011c6 0x1400011c6 0x140001d50
0x14000132c 0x140001355 0x14000145a 0x14000145a 0x140001d6b
0x14000132c 0x14000148e 0x1400014a0 0x14000145a 0x140001d6b
0x1400015d0 0x1400015d7 0x140001661 0x140001661 0x140001d89
[{"source":5368713232,"from":5368713292,"to":5368713318,"handler":5368713318,"filter":0},{"source":5368713232,"from":5368713250,"to":5368713334,"handler":5368713334,"filter":0},{"source":5368713232,"from":5368713348,"to":5368713364,"handler":5368713364,"filter":5368716592},{"source":5368713584,"from":5368713618,"to":5368713670,"handler":5368713670,"filter":5368716624},{"source":5368714028,"from":5368714069,"to":5368714330,"handler":5368714330,"filter":5368716651},{"source":5368714028,"from":5368714382,"to":5368714400,"handler":5368714330,"filter":5368716651},{"source":5368714704,"from":5368714711,"to":5368714849,"handler":5368714849,"filter":5368716681}]
EOF
RUN

NAME=PE: nested_collided.exe - Get trycatchs
FILE=bins/pe/microsoft_seh_tests/x64/nested_collided.exe
CMDS=iw;iwj
EXPECT=<<EOF
     source        from          to     handler      filter 
------------------------------------------------------------
0x140001160 0x140001164 0x14000116b 0x14000116b 0x140001fa0
0x1400011e0 0x140001207 0x14000120e 0x14000120e 0x140002000
0x1400011e0 0x140001273 0x14000127a 0x14000127a 0x140002016
0x1400013e4 0x14000140d 0x140001512 0x140001512 0x14000202c
0x1400013e4 0x140001546 0x140001558 0x140001512 0x14000202c
0x140001804 0x14000180b 0x140001895 0x140001895 0x14000204a
[{"source":5368713568,"from":5368713572,"to":5368713579,"handler":5368713579,"filter":5368717216},{"source":5368713696,"from":5368713735,"to":5368713742,"handler":5368713742,"filter":5368717312},{"source":5368713696,"from":5368713843,"to":5368713850,"handler":5368713850,"filter":5368717334},{"source":5368714212,"from":5368714253,"to":5368714514,"handler":5368714514,"filter":5368717356},{"source":5368714212,"from":5368714566,"to":5368714584,"handler":5368714514,"filter":5368717356},{"source":5368715268,"from":5368715275,"to":5368715413,"handler":5368715413,"filter":5368717386}]
EOF
RUN

NAME=PE: xcpt4.exe - Get trycatchs
FILE=bins/pe/microsoft_seh_tests/x64/xcpt4.exe
CMDS=iw
EXPECT=<<EOF
     source        from          to     handler      filter 
------------------------------------------------------------
0x1400010c0 0x1400010d1 0x1400010d7 0x140004ea0  0x00000000
0x1400010c0 0x1400010d1 0x1400010d8 0x1400010d8  0x00000000
0x1400011c0 0x1400011d1 0x1400011d3 0x140004f80  0x00000000
0x1400011c0 0x1400011d1 0x1400011e1 0x140004fa2  0x00000000
0x1400011c0 0x1400011d1 0x1400011ef 0x1400011ef 0x140004fbf
0x140001280 0x14000128e 0x140001297 0x140001297  0x00000000
0x140001280 0x14000128e 0x14000129c 0x140005030  0x00000000
0x1400012a0 0x1400012be 0x1400012dd 0x140004ff0  0x00000000
0x1400012a0 0x1400012b3 0x1400012de 0x14000130e  0x00000000
0x1400012a0 0x1400012b3 0x1400012de 0x14000500a  0x00000000
0x1400012a0 0x1400012e9 0x140001300 0x140004ff0  0x00000000
0x1400012a0 0x1400012e9 0x14000130e 0x14000130e  0x00000000
0x1400012a0 0x1400012e9 0x14000130e 0x14000500a  0x00000000
0x140001330 0x140001340 0x140001346 0x140001348  0x00000000
0x140001330 0x140001348 0x14000135a 0x140005040  0x00000000
0x140001330 0x140001340 0x14000135b 0x140005056  0x00000000
0x140001370 0x14000139a 0x1400013b9 0x140005070  0x00000000
0x140001370 0x14000139a 0x1400013ba 0x140001408  0x00000000
0x140001370 0x14000138f 0x1400013ba 0x14000509a  0x00000000
0x140001370 0x14000138f 0x1400013bb 0x14000142f  0x00000000
0x140001370 0x14000138f 0x1400013bb 0x1400050c4  0x00000000
0x140001370 0x1400013c6 0x1400013cf 0x1400013cf  0x00000000
0x140001370 0x1400013c6 0x1400013f1 0x140005070  0x00000000
0x140001370 0x1400013c6 0x140001406 0x140001408  0x00000000
0x140001370 0x1400013c6 0x140001416 0x14000509a  0x00000000
0x140001370 0x1400013c6 0x14000142f 0x14000142f  0x00000000
0x140001370 0x1400013c6 0x14000143c 0x1400050c4  0x00000000
0x140001450 0x140001460 0x140001466 0x14000146a  0x00000000
0x140001450 0x140001460 0x140001466 0x1400050f6  0x00000000
0x140001450 0x14000146a 0x14000147c 0x1400050e0  0x00000000
0x140001450 0x14000146a 0x14000147d 0x1400050f6  0x00000000
0x140001450 0x140001460 0x14000147e 0x14000147e  0x00000000
0x140001450 0x140001460 0x140001483 0x14000510c  0x00000000
0x140001450 0x140001460 0x140001487 0x140001487  0x00000000
0x140001450 0x140001460 0x14000148c 0x140005122  0x00000000
0x1400014a0 0x1400014b5 0x1400014bc 0x140005161  0x00000000
0x1400014a0 0x1400014b5 0x1400014bd 0x14000519f  0x00000000
0x1400014a0 0x1400014b5 0x1400014bf 0x1400014bf 0x1400051c7
0x1400014a0 0x1400014b5 0x1400014ca 0x1400014cc 0x1400051e8
0x1400014a0 0x1400014cc 0x1400014e6 0x140005209  0x00000000
0x1400014a0 0x1400014b5 0x1400014e7 0x140005235  0x00000000
0x1400014f0 0x1400014fc 0x140001504 0x140001504 0x140005270
0x1400014f0 0x1400014fc 0x140001506 0x140001506 0x14000528d
0x1400014f0 0x1400014fc 0x140001514 0x140001514 0x1400052a0
0x1400014f0 0x1400014fc 0x140001516 0x140001516 0x1400052b0
0x1400014f0 0x1400014fc 0x140001518 0x140001518  0x00000000
0x1400014f0 0x1400014fc 0x14000151a 0x14000151a  0x00000000
0x1400014f0 0x1400014fc 0x14000151c 0x14000151c  0x00000000
0x1400014f0 0x1400014fc 0x14000151c 0x1400052c0  0x00000000
0x140001530 0x14000154b 0x140001551 0x1400052d0  0x00000000
0x140001530 0x140001545 0x140001552 0x1400052ee  0x00000000
0x140001530 0x140001545 0x140001553 0x14000531d  0x00000000
0x140001530 0x140001545 0x140001555 0x140001555 0x140005345
0x140001570 0x140001591 0x1400015a1 0x1400015a1 0x140005370
0x140001820 0x140001830 0x140001832 0x1400053a0  0x00000000
0x140001820 0x140001830 0x140001834 0x140001834 0x1400053c3
0x140001850 0x140001865 0x140001867 0x1400053f0  0x00000000
0x140001850 0x140001865 0x140001869 0x140001869 0x140005429
0x140001880 0x140001895 0x140001897 0x140005450  0x00000000
0x140001880 0x140001895 0x140001898 0x140005487  0x00000000
0x140001880 0x140001895 0x14000189a 0x14000189a 0x1400054af
0x1400018b0 0x1400018c5 0x1400018c7 0x1400054e0  0x00000000
0x1400018b0 0x1400018c5 0x1400018c8 0x140005517  0x00000000
0x1400018b0 0x1400018c5 0x1400018ca 0x1400018ca 0x140005544
0x1400018e0 0x1400018f5 0x1400018f7 0x140005570  0x00000000
0x1400018e0 0x1400018f5 0x1400018f8 0x140005598  0x00000000
0x1400018e0 0x1400018f5 0x1400018fa 0x1400018fa 0x1400055cf
0x140001910 0x140001925 0x140001927 0x140005600  0x00000000
0x140001910 0x140001925 0x140001928 0x140005628  0x00000000
0x140001910 0x140001925 0x14000192a 0x14000192a 0x140005664
0x140001940 0x140001955 0x140001957 0x140005690  0x00000000
0x140001940 0x140001955 0x140001959 0x140001959 0x1400056bb
0x140001940 0x140001955 0x140001960 0x1400056dc  0x00000000
0x140001940 0x140001955 0x140001962 0x140001962 0x140005713
0x140001970 0x140001985 0x140001987 0x140005740  0x00000000
0x140001970 0x140001985 0x140001989 0x140001989 0x14000576b
0x140001970 0x140001985 0x140001990 0x14000578c  0x00000000
0x140001970 0x140001985 0x140001992 0x140001992 0x1400057c8
0x1400019a0 0x1400019b5 0x1400019b7 0x1400057f0  0x00000000
0x1400019a0 0x1400019b5 0x1400019b9 0x1400019b9 0x14000581b
0x1400019a0 0x1400019b5 0x1400019c0 0x140005840  0x00000000
0x1400019a0 0x1400019b5 0x1400019c2 0x1400019c2 0x140005877
0x1400019d0 0x1400019e5 0x1400019e7 0x1400058a0  0x00000000
0x1400019d0 0x1400019e5 0x1400019e9 0x1400019e9 0x1400058d0
0x1400019d0 0x1400019e5 0x1400019f0 0x1400058f1  0x00000000
0x1400019d0 0x1400019e5 0x1400019f2 0x1400019f2 0x140005928
0x140001a00 0x140001a18 0x140001a24 0x140001a24  0x00000000
0x140001a00 0x140001a68 0x140001a74 0x140001a74  0x00000000
0x140001a00 0x140001ab8 0x140001ac4 0x140001ac4  0x00000000
0x140001a00 0x140001b08 0x140001b14 0x140001b14  0x00000000
0x140001a00 0x140001b58 0x140001b64 0x140001b64  0x00000000
0x140001a00 0x140001ba8 0x140001bb4 0x140001bb4  0x00000000
0x140001a00 0x140001bf8 0x140001c04 0x140001c04  0x00000000
0x140001a00 0x140001c48 0x140001c54 0x140001c54  0x00000000
0x140001a00 0x140001c98 0x140001ca4 0x140001ca4  0x00000000
0x140001a00 0x140001ce8 0x140001cf4 0x140001cf4  0x00000000
0x140001e30 0x140001e42 0x140001e4d 0x140001e55 0x1400059d0
0x140001e30 0x140001e42 0x140001e4d 0x1400059f0  0x00000000
0x140001e30 0x140001e55 0x140001e6e 0x1400059f0  0x00000000
0x140001f00 0x140001f0d 0x140001f25 0x140001f25 0x140005a10
0x140001fa0 0x140001fad 0x140001fc3 0x140005a70  0x00000000
0x140001fa0 0x140001fc4 0x140001fdc 0x140001fdc  0x00000000
0x140002000 0x14000206a 0x140002075 0x140005ab0  0x00000000
0x140002000 0x14000209f 0x1400020ad 0x1400020ad 0x140005ac0
0x140002000 0x1400020f1 0x140002118 0x140002118 0x140005ad6
0x140002000 0x14000215c 0x140002183 0x140002183 0x140005aec
0x140002000 0x1400021c7 0x1400021e4 0x1400021e4 0x140005b02
0x140002000 0x140002228 0x140002247 0x140005b18  0x00000000
0x140002000 0x140002228 0x140002250 0x140002250 0x140005b38
0x140002000 0x14000229d 0x1400022b8 0x140005b4e  0x00000000
0x140002000 0x14000229d 0x1400022ba 0x1400022ba 0x140005b6e
0x140002000 0x140002307 0x140002325 0x140002325 0x140005b84
0x140002000 0x140002369 0x14000238c 0x14000238c 0x140005bae
0x140002000 0x1400023d0 0x1400023e6 0x1400023e6 0x140005bd8
0x140002000 0x14000242a 0x14000244a 0x14000244a 0x140005c02
0x140002000 0x14000248e 0x1400024a1 0x1400024a1 0x140005c2c
0x140002000 0x1400024a8 0x1400024b8 0x1400024b8 0x140005c56
0x140002000 0x140002522 0x14000253a 0x14000253a 0x140005c7c
0x140002000 0x140002541 0x140002551 0x140002551 0x140005ca6
0x140002000 0x1400025bb 0x1400025c6 0x1400025cf 0x140005ccc
0x140002000 0x1400025bb 0x1400025c6 0x140005cf6  0x00000000
0x140002000 0x1400025cf 0x1400025e8 0x140005cf6  0x00000000
0x140002000 0x140002624 0x14000262f 0x140005d0c  0x00000000
0x140002000 0x140002624 0x14000264c 0x140005d33  0x00000000
0x140002000 0x140002688 0x14000269e 0x1400026a7  0x00000000
0x140002000 0x140002688 0x14000269e 0x140005d49  0x00000000
0x140002000 0x1400026a7 0x1400026c0 0x140005d49  0x00000000
0x140002000 0x140002688 0x1400026c2 0x140005d5f  0x00000000
0x140002000 0x140002706 0x140002711 0x140005d6f  0x00000000
0x140002000 0x140002706 0x14000271d 0x140005d96  0x00000000
0x140002000 0x140002759 0x140002772 0x140005da6  0x00000000
0x140002000 0x1400027ae 0x1400027c7 0x140005db6  0x00000000
0x140002000 0x14000288e 0x14000289e 0x140005dc6  0x00000000
0x140002000 0x1400028fd 0x14000291d 0x140005de8  0x00000000
0x140002000 0x140002990 0x1400029ab 0x140005e20  0x00000000
0x140002000 0x140002990 0x1400029c6 0x1400029c6  0x00000000
0x140002000 0x140002a30 0x140002a4b 0x140005e42  0x00000000
0x140002000 0x140002a30 0x140002a5b 0x140005e58  0x00000000
0x140002000 0x140002a30 0x140002a78 0x140005e7a  0x00000000
0x140002000 0x140002a30 0x140002a79 0x140002a79  0x00000000
0x140002000 0x140002ae3 0x140002b00 0x140005e90  0x00000000
0x140002000 0x140002ae3 0x140002b11 0x140005ea6  0x00000000
0x140002000 0x140002ae3 0x140002b1c 0x140002b1c  0x00000000
0x140002000 0x140002b86 0x140002ba3 0x140005ebc  0x00000000
0x140002000 0x140002b86 0x140002bb3 0x140005ed2  0x00000000
0x140002000 0x140002b86 0x140002bd0 0x140005ef4  0x00000000
0x140002000 0x140002b86 0x140002bd1 0x140002bd1  0x00000000
0x140002000 0x140002c27 0x140002c46 0x140002c46 0x140005f0a
0x140002000 0x140002c27 0x140002c62 0x140002c62  0x00000000
0x140002000 0x140002ca7 0x140002cc8 0x140002cc8 0x140005f2e
0x140002000 0x140002d36 0x140002d47 0x140002d47  0x00000000
0x140002000 0x140002db5 0x140002dd5 0x140005f58  0x00000000
0x140002000 0x140002e37 0x140002e46 0x140002e46  0x00000000
0x140002000 0x140002e37 0x140002e69 0x140002e69  0x00000000
0x140002000 0x140002ed5 0x140002ef5 0x140005f6f  0x00000000
0x140002000 0x140002ed5 0x140002f09 0x140005f86  0x00000000
0x140002000 0x140002f6b 0x140002f79 0x140005f9d  0x00000000
0x140002000 0x140002fdb 0x140002fe9 0x140005fc5  0x00000000
0x140002000 0x140002fdb 0x140003005 0x140005fed  0x00000000
0x140002000 0x140003065 0x140003073 0x140006004  0x00000000
0x140002000 0x140003065 0x140003087 0x14000601b  0x00000000
0x140002000 0x1400030f5 0x140003108 0x140003108  0x00000000
0x140002000 0x140003175 0x140003195 0x140006043  0x00000000
0x140002000 0x1400031f6 0x140003205 0x140003205  0x00000000
0x140002000 0x1400031f6 0x140003228 0x140003228  0x00000000
0x140002000 0x14000328d 0x1400032ad 0x14000605a  0x00000000
0x140002000 0x14000328d 0x1400032c1 0x140006071  0x00000000
0x140002000 0x14000335d 0x14000337a 0x1400060d8  0x00000000
0x140002000 0x1400033b6 0x1400033cc 0x140006106  0x00000000
0x140002000 0x14000342b 0x14000342d 0x14000342d  0x00000000
0x140002000 0x14000348a 0x14000349c 0x14000612e  0x00000000
0x140002000 0x1400034f3 0x1400034f5 0x1400034f5  0x00000000
0x140002000 0x1400034f3 0x140003512 0x140003512  0x00000000
0x140002000 0x140003572 0x140003584 0x140006145  0x00000000
0x140002000 0x140003572 0x140003585 0x14000615c  0x00000000
0x140002000 0x1400035d8 0x1400035df 0x140006173  0x00000000
0x140002000 0x14000363f 0x14000364a 0x14000619b  0x00000000
0x140002000 0x14000363f 0x140003667 0x1400061c3  0x00000000
0x140002000 0x1400036ba 0x1400036c5 0x1400061da  0x00000000
0x140002000 0x1400036ba 0x1400036db 0x1400061f1  0x00000000
0x140002000 0x14000372e 0x14000375b 0x140006219  0x00000000
0x140002000 0x140003796 0x1400037ef 0x140006229  0x00000000
0x140002000 0x140003825 0x14000384d 0x140006239  0x00000000
0x140002000 0x140003886 0x1400038b0 0x140006249  0x00000000
0x140002000 0x140003886 0x1400038cf 0x140006267  0x00000000
0x140002000 0x14000390b 0x140003933 0x140006277  0x00000000
0x140002000 0x14000390b 0x14000393b 0x1400062a9  0x00000000
0x140002000 0x140003980 0x1400039a7 0x1400039a7 0x1400062b9
0x140002000 0x1400039a7 0x1400039b8 0x1400062cf  0x00000000
0x140002000 0x1400039f6 0x140003a01 0x1400062df  0x00000000
0x140002000 0x140003a02 0x140003a0d 0x140006316  0x00000000
0x140002000 0x140003a37 0x140003a42 0x140006326  0x00000000
0x140002000 0x140003a43 0x140003a6a 0x140003a6a 0x14000638d
0x140002000 0x140003a6a 0x140003a7b 0x1400063a3  0x00000000
0x140002000 0x140003ab9 0x140003ae0 0x140003ae0 0x1400063b3
0x140002000 0x140003ae0 0x140003b04 0x140003b04 0x1400063c9
0x140002000 0x140003b49 0x140003b4b 0x140003b4b  0x00000000
0x140002000 0x140003b49 0x140003b70 0x140003b70  0x00000000
0x140002000 0x140003bb5 0x140003bcb 0x140003bcb  0x00000000
0x140002000 0x140003c59 0x140003c71 0x140003c71  0x00000000
0x140002000 0x140003c43 0x140003c86 0x140003c86  0x00000000
0x140002000 0x140003ce7 0x140003cf2 0x1400063e2  0x00000000
0x140002000 0x140003ce7 0x140003d19 0x140003d19  0x00000000
0x140002000 0x140003d5e 0x140003d7d 0x14000640d  0x00000000
0x140002000 0x140003d5e 0x140003da1 0x140003da1  0x00000000
0x140002000 0x140003de6 0x140003df1 0x140006438  0x00000000
0x140002000 0x140003de6 0x140003e1d 0x140003e1d  0x00000000
0x140002000 0x140003e6c 0x140003e8c 0x140006462  0x00000000
0x140002000 0x140003e6c 0x140003ead 0x140003ead  0x00000000
0x140002000 0x140003ef6 0x140003efa 0x14000648c  0x00000000
0x140002000 0x140003efb 0x140003f02 0x1400064e7  0x00000000
0x140002000 0x140003ef6 0x140003f1a 0x140003f1a  0x00000000
0x140002000 0x140003f58 0x140003f6c 0x140006509  0x00000000
0x140002000 0x140003f6d 0x140003f74 0x14000656c  0x00000000
0x140002000 0x140003f58 0x140003f9b 0x140003f9b  0x00000000
0x140004150 0x140004179 0x14000427e 0x14000427e 0x14000658e
0x140004150 0x1400042b2 0x1400042c4 0x14000427e 0x14000658e
0x140004578 0x14000457f 0x140004609 0x140004609 0x1400065ac
0x140005a70 0x140005a7a 0x140005a97 0x140005a97  0x00000000
0x140006326 0x140006334 0x140006351 0x140006351 0x14000635f
0x140006326 0x140006351 0x140006358 0x140006379  0x00000000
EOF
RUN

NAME=PE: xframe_eh_dll.dll - Get trycatchs
FILE=bins/pe/microsoft_seh_tests/x64/xframe_eh_dll.dll
CMDS=iw
EXPECT=<<EOF
     source        from          to     handler      filter 
------------------------------------------------------------
0x180001050 0x180001058 0x18000105e 0x180001f40  0x00000000
0x180001050 0x180001058 0x18000107a 0x18000107a 0x180001f6a
0x1800010c0 0x1800010c4 0x1800010d8 0x180001f90  0x00000000
0x1800010c0 0x1800010c4 0x1800010f4 0x1800010f4 0x180001fba
0x180001120 0x180001124 0x180001135 0x180001135 0x180001fe0
0x180001160 0x180001164 0x180001173 0x180002000  0x00000000
0x180001160 0x180001164 0x18000118f 0x18000118f 0x18000202a
0x1800013cc 0x180001401 0x1800014e7 0x1800014e7 0x180002086
0x180001a18 0x180001a1f 0x180001aa9 0x180001aa9 0x1800020bc
EOF
RUN

NAME=PE: xframe_eh_exe.exe - Get trycatchs
FILE=bins/pe/microsoft_seh_tests/x64/xframe_eh_exe.exe
CMDS=iw
EXPECT=<<EOF
     source        from          to     handler      filter 
------------------------------------------------------------
0x140001160 0x140001164 0x140001173 0x140002480  0x00000000
0x140001160 0x140001164 0x14000118f 0x14000118f 0x1400024aa
0x1400011b0 0x1400011b4 0x1400011c8 0x1400024c0  0x00000000
0x1400011b0 0x1400011b4 0x1400011e4 0x1400011e4 0x1400024ea
0x140001220 0x14000123e 0x14000124d 0x14000124d 0x140002500
0x140001220 0x14000129e 0x1400012ad 0x1400012ad 0x140002516
0x140001220 0x1400012fe 0x14000130d 0x14000130d 0x14000252c
0x140001220 0x14000135e 0x14000136d 0x14000136d 0x140002542
0x140001220 0x1400013be 0x1400013cd 0x1400013cd 0x140002558
0x140001220 0x14000141e 0x14000142d 0x14000142d 0x14000256e
0x140001220 0x14000147e 0x140001486 0x140001486 0x140002584
0x140001220 0x1400014d7 0x1400014e6 0x1400014e6 0x14000259a
0x140001220 0x140001537 0x140001546 0x140001546 0x1400025b0
0x1400016a0 0x1400016be 0x1400016cd 0x1400016cd 0x1400025d0
0x1400016a0 0x140001723 0x14000172b 0x14000172b 0x1400025ee
0x1400018c4 0x1400018ed 0x1400019f2 0x1400019f2 0x14000260c
0x1400018c4 0x140001a26 0x140001a38 0x1400019f2 0x14000260c
0x140001ce4 0x140001ceb 0x140001d75 0x140001d75 0x14000262a
EOF
RUN
